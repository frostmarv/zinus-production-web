Saya menemukan masalahnya! ğŸ”

Error 400 Bad Request terjadi karena frontend mengirim field remainQuantity yang tidak ada di DTO backend!

Backend DTO tidak expect field remainQuantity karena kita sudah refactor untuk tidak menyimpan remainQuantity di database (sudah dicompute real-time).

Mari saya perbaiki frontend untuk tidak mengirim remainQuantity:


Opened attached_assets/InputCutting_1759336639072.jsx

Decided on remainQuantity handling
Saya temukan masalahnya! Di line 425, frontend mengirim remainQuantity tapi backend tidak expect field ini.

Karena kita sudah refactor untuk tidak menyimpan remainQuantity di database (computed real-time), field ini harus dihapus dari data submit:


Executed cat > /tmp/fix_input_cutting.patch << 'EOF' --- Line 402-426: Remove remainQuantity from submitted data entries: formEntries.map( ({ id, customers, poNumbers, customerPOs, skus, sCodes, sCodesData, plannedQtyCache, + remainQuantity, ...entry }) => { const customerName = customers.find((c) => c.value == entry.customerId)?.label || ""; return { customer: customerName, poNumber: entry.poNumber, customerPO: entry.customerPO, sku: entry.sku, sCode: entry.sCode, description: entry.description, quantityOrder: Number(entry.quantityOrder) || 0, quantityProduksi: Number(entry.quantityProduksi) || 0, week: entry.week, - remainQuantity: Number(entry.remainQuantity) || 0, }; }, ), EOF cat /tmp/fix_input_cutting.patch

Decided on frontend code changes
ğŸ” Masalah Ditemukan!
Error 400 Bad Request terjadi karena:

Root Cause:
Frontend mengirim field remainQuantity (line 425) yang tidak ada di DTO backend!

// âŒ SALAH - Backend tidak expect field ini
return {
  ...
  week: entry.week,
  remainQuantity: Number(entry.remainQuantity) || 0,  // <-- Tidak ada di DTO!
};
Kenapa Error?
Karena kita sudah refactor remainQuantity:

âœ… Dulu: Disimpan di database
âœ… Sekarang: Dihitung real-time dari API /api/master-data/remain-quantity
Backend DTO validation menolak field yang tidak dikenal karena forbidNonWhitelisted: true.

âœ… Solusi: Update Frontend Code
File: InputCutting.jsx (Line 401-426)

Perubahan yang perlu dilakukan:

Tambahkan remainQuantity ke destructured fields (sehingga tidak dikirim):
entries: formEntries.map(
  ({
    id,
    customers,
    poNumbers,
    customerPOs,
    skus,
    sCodes,
    sCodesData,
    plannedQtyCache,
    remainQuantity,        // âœ… TAMBAHKAN INI - supaya tidak dikirim ke backend
    ...entry
  }) => {
Hapus baris yang mengirim remainQuantity (line 425):
return {
  customer: customerName,
  poNumber: entry.poNumber,
  customerPO: entry.customerPO,
  sku: entry.sku,
  sCode: entry.sCode,
  description: entry.description,
  quantityOrder: Number(entry.quantityOrder) || 0,
  quantityProduksi: Number(entry.quantityProduksi) || 0,
  week: entry.week,
  // âŒ HAPUS BARIS INI:
  // remainQuantity: Number(entry.remainQuantity) || 0,
};
ğŸ“ Code Yang Benar
// Line 401-426 - CORRECTED VERSION
entries: formEntries.map(
  ({
    id,
    customers,
    poNumbers,
    customerPOs,
    skus,
    sCodes,
    sCodesData,
    plannedQtyCache,
    remainQuantity,        // âœ… Destructure ini supaya tidak masuk ke ...entry
    ...entry
  }) => {
    const customerName =
      customers.find((c) => c.value == entry.customerId)?.label || "";
    return {
      customer: customerName,
      poNumber: entry.poNumber,
      customerPO: entry.customerPO,
      sku: entry.sku,
      sCode: entry.sCode,
      description: entry.description,
      quantityOrder: Number(entry.quantityOrder) || 0,
      quantityProduksi: Number(entry.quantityProduksi) || 0,
      week: entry.week,
      // âœ… remainQuantity TIDAK dikirim ke backend (karena tidak disimpan di DB)
    };
  },
),
ğŸ¯ Summary
Yang Perlu Diubah:

âœ… Line 410: Tambahkan remainQuantity, ke destructuring
âœ… Line 425: Hapus baris remainQuantity: Number(entry.remainQuantity) || 0,
Setelah fix ini:

âœ… Backend akan menerima data dengan format yang benar
âœ… Submit akan berhasil tanpa error 400
âœ… RemainQuantity tetap ditampilkan di UI (hanya untuk display, tidak disimpan)
Backend sudah benar, tinggal update frontend saja! ğŸš€